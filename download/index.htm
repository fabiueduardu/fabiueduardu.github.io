
<!doctype html>
<html lang="en" ng-app="uiApp">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="download instagram videos">
    <meta name="author" content="JSpank">
    <title>JSpank</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">  </head>
  <body>
<div  ng-controller="appController" ng-cloak>
    <header>
      <div class="collapse bg-dark" id="navbarHeader">
        <div class="container">
          <div class="row">
            <div class="col-sm-8 col-md-7 py-4">
              <h4 class="text-white">About</h4>
              <p class="text-muted">Aliquam quis libero id turpis mattis elementum.</p>
            </div>
            <div class="col-sm-4 offset-md-1 py-4">
              <h4 class="text-white">Contact</h4>
              <ul class="list-unstyled">
                <li><a href="https://twitter.com/fabiueduardu" class="text-white" target=_blank>Twitter</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="navbar navbar-dark bg-dark box-shadow">
        <div class="container d-flex justify-content-between">
          <a href="." class="navbar-brand d-flex align-items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
            <strong>JSpank</strong>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
      </div>
    </header>

    <main role="main">

      <section class="jumbotron text-center">
        <div class="container">
        <form>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" >

                                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                width="20" height="20" viewBox="0 0 510 510" style="enable-background:new 0 0 510 510;" xml:space="preserve">
                           <g>
                               <g id="post-instagram">
                                   <path d="M459,0H51C22.95,0,0,22.95,0,51v408c0,28.05,22.95,51,51,51h408c28.05,0,51-22.95,51-51V51C510,22.95,487.05,0,459,0z
                                        M255,153c56.1,0,102,45.9,102,102c0,56.1-45.9,102-102,102c-56.1,0-102-45.9-102-102C153,198.9,198.9,153,255,153z M63.75,459
                                       C56.1,459,51,453.9,51,446.25V229.5h53.55C102,237.15,102,247.35,102,255c0,84.15,68.85,153,153,153c84.15,0,153-68.85,153-153
                                       c0-7.65,0-17.85-2.55-25.5H459v216.75c0,7.65-5.1,12.75-12.75,12.75H63.75z M459,114.75c0,7.65-5.1,12.75-12.75,12.75h-51
                                       c-7.65,0-12.75-5.1-12.75-12.75v-51c0-7.65,5.1-12.75,12.75-12.75h51C453.9,51,459,56.1,459,63.75V114.75z"/>
                               </g>
                           </g></g>
                           </svg>

                            <strong>  *URL</strong></span>
                    </div>
                    <input type="text" id="url_download" required ng-model="url_download" class="form-control input-lg"  autocomplete="off" >   
                 </div> 
                 
                        <button type="button" class="btn btn-success" ng-click="download();" ng-disabled="download_started">Download</button>
                        <button type="button" class="btn btn-danger" ng-click="clearCache();">Clear Cache</button> 
                        <button type="reset" class="btn btn-warning" >Reset</button> 
                        <hr>
                        <div ng-show="itens.length>0">{{itens.length}} Record(s)
                                <span ng-show="searchTerm"> to <strong>{{searchTerm}}</strong>
                        </div> 
                        <div ng-hide="itens.length>0"  >No records found!
                            <span ng-show="searchTerm"> to <strong>{{searchTerm}}</strong></span>
                        </div>
           </form> 
        </div>
      </section>
    
        <div class="container">
            
                <div class="row">     
                     <div class="col-md-9" >
                </div>            
                     <div class="col-md-3" >
                            <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" > 
                                                <svg height="32" class="octicon octicon-search" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
                                          </span>
                                    </div>
                            <input type="text" maxlength="20" ng-change="contentsFilter();" placeholder="Search..." ng-model="searchTerm"  class="form-control input-lg" >
                    </div></div>
                </div>
          <div class="row">              
            <div class="col-md-3" ng-repeat="item in itens track by $index">
                <div class="card mb-3 box-shadow" >
                    <a href="{{item.linkOriginal}}" title="{{item.description}}" target="_blank" >
                         <img class="card-img-top"  src="{{item.thumbUrl}}" title="{{item.description}}"  >
                     </a>
                    <div class="card-body">
                    <p class="card-text"><span class="badge badge-light">{{$index+1}}</span>
                        {{item.description}} </p>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group"> 
                            <a href="{{item.link}}" target="_blank" title="View, Download"><svg height="32" class="octicon octicon-cloud-download" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M9 12h2l-3 3-3-3h2V7h2v5zm3-8c0-.44-.91-3-4.5-3C5.08 1 3 2.92 3 5 1.02 5 0 6.52 0 8c0 1.53 1 3 3 3h3V9.7H3C1.38 9.7 1.3 8.28 1.3 8c0-.17.05-1.7 1.7-1.7h1.3V5c0-1.39 1.56-2.7 3.2-2.7 2.55 0 3.13 1.55 3.2 1.8v1.2H12c.81 0 2.7.22 2.7 2.2 0 2.09-2.25 2.2-2.7 2.2h-2V11h2c2.08 0 4-1.16 4-3.5C16 5.06 14.08 4 12 4z"></path></svg></a>
                            <a href="#{{$index}}" ng-click="remove($index)" title="Remove"><svg height="32" class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg></a>
                            <a href="whatsapp://send?text={{item.link}}" class="d-xl-none"  data-action="share/whatsapp/share" title="Share on WhatsApp"><svg height="32" class="octicon octicon-comment-discussion" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M15 1H6c-.55 0-1 .45-1 1v2H1c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h1v3l3-3h4c.55 0 1-.45 1-1V9h1l3 3V9h1c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zM9 11H4.5L3 12.5V11H1V5h4v3c0 .55.45 1 1 1h3v2zm6-3h-2v1.5L11.5 8H6V2h9v6z"></path></svg></a>
                        </div>
                     <small class="text-muted">{{item.dateCreate}}</small>
                    </div>
                 </div>              
                </div>
            </div>
          </div>
        </div>    

    </main>

 
    <footer class="text-muted">
        
      <div class="container">
            <hr>
        <p class="float-right">
          <a href="#">Back to top</a>
        </p>
        <i>Ⓡ2018, JSpank</i>
     </div>
    </footer>
</div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.2/angular.min.js"></script>
    <script>
       var indexOfMp4 = '.mp4';
       var maxVideSearch = 100;
       var storageDelimiter = ';';
       var storageDelimiterItem = '|'; 
       var indexOfTitle = '<title>';
       var indexOfTitleEnd = '</title>';
       var indexOfThumb = 'property="og:image" content="';
       var indexOfThumbEnd = '"';
       var loadStorageKey = 'jsDownloads';
       var hasQueryString = '?';
       var endValue = '"';
       var messages =  {
            not_found:'Not found',
            has_error:'There was an error, please try again.',
            url_required :'URL required!'
           };

        angular.module('uiApp', [])
            .controller('appController', function( $scope) {
                $scope.itens = [];
                $scope.itens_readonly = [];
 
                $scope.LoadLocalStorage = function(){
                
                    try{
                            $scope.itens = [];
                            $scope.itens_readonly = [];

                            var localStorageValue = localStorage.getItem(loadStorageKey);                                
                           if(localStorageValue)
                            {
                                var itens = JSON.parse(localStorageValue);
                                $(itens).each(function(i, item){
                                    $scope.itens.splice(0, 0, item);
                                });
                                $scope.itens_readonly = $scope.itens;
                           }
                    }catch(error){
                        }
                }

               
                $scope.contentsFilter = function(){
                     $scope.itens  = $scope.itens_readonly.filter(function(value){
                       return     !$scope.searchTerm 
                                || $scope.searchTerm=='' 
                                || value.description.indexOf($scope.searchTerm)!= -1;
                    }); 
                }

                $scope.getLink = function(text){
                    var i= 0;
                    for(i=text.length;i>=0;i--)
                        if(text[i]=='"')
                            break;
        
                    return text.substring(i+1);
                };

                $scope.getThumb = function(data)
                {
                var indexOf = data.indexOf(indexOfThumb);
                data = data.substring(indexOf+indexOfThumb.length);
                var indexOfIend = data.indexOf(indexOfThumbEnd);
                var substringAt = data.substring(0,indexOfIend);
                if(indexOf==-1) return '';

                return substringAt;
                }

                $scope.getTitle = function(data)
                {
                    var indexOf = data.indexOf(indexOfTitle);
                    var indexOfIend = data.indexOf(indexOfTitleEnd);
                    var substringAt = data.substring(indexOf+indexOfTitle.length,indexOfIend);
                    if(indexOf==-1) return '';

                    return substringAt;
                }

                $scope.clearCache=function(){
                    localStorage.removeItem(loadStorageKey);
                    $scope.LoadLocalStorage();
                };

                $scope.remove = function(index){
                    $scope.itens.splice(index, 1);
                    $scope.itens_readonly.splice(index, 1); 
                    localStorage.setItem(loadStorageKey,JSON.stringify($scope.itens));

                }
                $scope.download =function(){
                     var links = [];
                    var url = $scope.url_download;

                    if(!url)
                        return alert(messages.url_required);
                    
                    $scope.download_started = true;
                    $.ajax({
                        url:url,
                        type: 'GET',
                        success: function(data){ 
                                var dataHTML = data; 

                                var itemLinkThumb = $scope.getThumb(dataHTML);
                                var itemTitle = $scope.getTitle(dataHTML);
                                var links = [];
                                var item_default = {
                                        link: itemLinkThumb
                                        ,thumbUrl: itemLinkThumb
                                        ,dateCreate: new Date().toLocaleDateString()+' '+new Date().toLocaleTimeString()
                                        ,description : itemTitle
                                        ,linkOriginal: url
                                    };

                                var substringAtSearch = function(data){
                                    var substringAt = data.substring(0,indexOf + indexOfMp4.length+1); 
                                    if(substringAt[substringAt.length-1]==hasQueryString)
                                   {
                                        var tmp  = data.substring(substringAt.length);
                                        substringAt += tmp.substring(0, tmp.indexOf(endValue));
                                       
                                    }
                                    else{
                                     substringAt += substringAt.substring(0, substringAt.length-1);
                                    }
 
                                    return substringAt;
                                }
                     
                                var indexOf = data.indexOf(indexOfMp4);
                                var substringAt = substringAtSearch(data);
                                data = data.substring(indexOf+ indexOfMp4.length);
                                var totalLink = 0;
                                while(indexOf != -1)
                                {
                                    var  link = $scope.getLink(substringAt); 
                                    indexOf = data.indexOf(indexOfMp4);
                                    substringAt = substringAtSearch(data);
                                    data = data.substring(indexOf+ indexOfMp4.length);  
                                    totalLink++;
                                    
                                    if(links.indexOf(link)!=-1)
                                        continue;

                                    var item  = {
                                            link:link
                                            ,thumbUrl: item_default.thumbUrl
                                            ,dateCreate: new Date().toLocaleDateString()+' '+new Date().toLocaleTimeString()
                                            ,description : item_default.description
                                            ,linkOriginal: url
                                    };

                                    $scope.itens.splice(0, 0, item);
                                    $scope.itens_readonly.splice(0, 0, item);

                                    if(links.indexOf(link)===-1);
                                        links.push(link);
                                    if(totalLink>=maxVideSearch)
                                        break;
                                }

                                if(links.length == 0 )
                                {
                                    $scope.itens.splice(0, 0, item_default);
                                    $scope.itens_readonly.splice(0, 0, item_default);
                                }
                                
                                localStorage.setItem(loadStorageKey,JSON.stringify($scope.itens));

                                 $scope.download_started = false;
                                $scope.$apply(); 
                        },
                        error: function(data) {
                            alert(messages.has_error + '['+ data.statusText + ']');
                            $scope.download_started = false;
                            console.log(data);
                        } 
                    }); 
                }

                $scope.LoadLocalStorage(); 
                
                if(location.hash){
                    var url_download = location.hash.substring(1);
                      $scope.url_download =url_download;  

                    setTimeout(function(){
                      var $itemTarget = $('a[href="'+url_download+'"]:last');
                      if($itemTarget.length) {
                        $itemTarget.parents('.card').addClass('bg-success'); 
                            $([document.documentElement, document.body]).animate({
                                scrollTop: $itemTarget.offset().top
                            }, 2000);
                        }else{
                            $scope.download(); 
                        }
                    },1000);
                }
            });
            
    </script>
  </body>
</html>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-76968512-2"></script>
   <script>
       window.dataLayer = window.dataLayer || [];
       function gtag() { dataLayer.push(arguments); }
       gtag('js', new Date());

       gtag('config', 'UA-76968512-2');
   </script>